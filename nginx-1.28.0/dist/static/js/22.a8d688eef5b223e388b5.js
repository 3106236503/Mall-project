webpackJsonp([22],{Gu7T:function(e,t,i){"use strict";t.__esModule=!0;var s,a=i("c/Tr"),l=(s=a)&&s.__esModule?s:{default:s};t.default=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return(0,l.default)(e)}},dPZK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("lHA8"),a=i.n(s),l=i("Gu7T"),r=i.n(l),n=i("Dd8w"),o=i.n(n),c=i("woOf"),u=i.n(c),m=i("n97X"),g=i("xT6B"),d={pageNum:1,pageSize:10,name:null,status:null},p={id:null,name:null,growthPoint:0,defaultDiscount:100,freeFreightPoint:0,defaultStatus:0,status:0,commentGrowthPoint:0,priviledgeFreeFreight:0,priviledgeSignIn:0,priviledgeComment:0,priviledgePromotion:0,priviledgeMemberPrice:0,priviledgeBirthday:0},v={name:[{required:!0,message:"请输入等级名称",trigger:"blur"},{min:1,max:20,message:"等级名称长度在1到20个字符",trigger:"blur"}],growthPoint:[{required:!0,message:"请输入成长值下限",trigger:"blur"},{type:"number",message:"成长值必须为数字",trigger:"blur"},{min:0,message:"成长值不能小于0",trigger:"blur"}],freeFreightPoint:[{type:"number",message:"免运费标准必须为数字",trigger:"blur"},{min:0,message:"免运费标准不能小于0",trigger:"blur"}],defaultDiscount:[{required:!0,message:"请输入默认折扣",trigger:"blur"},{type:"number",message:"默认折扣必须为数字",trigger:"blur"},{min:1,max:100,message:"默认折扣必须在1到100之间",trigger:"blur"}],commentGrowthPoint:[{type:"number",message:"评论成长值必须为数字",trigger:"blur"},{min:0,message:"评论成长值不能小于0",trigger:"blur"}]},h={name:"memberLevelList",data:function(){return{listQuery:u()({},d),list:[],total:0,currentPage:1,listLoading:!1,dialogVisible:!1,memberLevel:u()({},p),isEdit:!1,levelNameOptions:[],validateRules:v,privilegeList:[]}},watch:{currentPage:function(e){this.listQuery.pageNum=e},"listQuery.pageNum":function(e){this.currentPage=e}},created:function(){this.getList()},filters:{formatDateTime:function(e){if(null==e||""===e)return"N/A";var t=new Date(e);return Object(g.a)(t,"yyyy-MM-dd hh:mm:ss")}},methods:{handleResetSearch:function(){this.listQuery=u()({},d)},handleSearchList:function(){this.listQuery.pageNum=1,this.getList()},handleSizeChange:function(e){this.listQuery.pageNum=1,this.currentPage=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.currentPage=e,this.getList()},handlePrevClick:function(e){this.listQuery.pageNum=e,this.currentPage=e,this.getList()},handleNextClick:function(e){this.listQuery.pageNum=e,this.currentPage=e,this.getList()},hasPrivileges:function(e){return e.priviledgeFreeFreight||e.priviledgeSignIn||e.priviledgeComment||e.priviledgePromotion||e.priviledgeMemberPrice||e.priviledgeBirthday},handleAdd:function(){this.dialogVisible=!0,this.isEdit=!1,this.memberLevel=u()({},p),this.privilegeList=[]},handleUpdate:function(e,t){this.dialogVisible=!0,this.isEdit=!0,this.memberLevel=u()({},t),this.privilegeList=[],t.priviledgeFreeFreight&&this.privilegeList.push("priviledgeFreeFreight"),t.priviledgeSignIn&&this.privilegeList.push("priviledgeSignIn"),t.priviledgeComment&&this.privilegeList.push("priviledgeComment"),t.priviledgePromotion&&this.privilegeList.push("priviledgePromotion"),t.priviledgeMemberPrice&&this.privilegeList.push("priviledgeMemberPrice"),t.priviledgeBirthday&&this.privilegeList.push("priviledgeBirthday")},handleDelete:function(e,t){var i=this;this.$confirm("是否要删除该会员等级?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(m.b)(t.id).then(function(e){e&&200===e.code?(i.$message({type:"success",message:"删除成功!"}),i.getList()):i.$message({type:"error",message:e&&e.message?e.message:"删除失败!"})}).catch(function(e){i.$message({type:"error",message:"网络错误，请稍后重试!"}),console.error("删除会员等级失败:",e)})}).catch(function(){i.$message({type:"info",message:"取消删除"})})},handleStatusChange:function(e,t){var i=this,s=t.defaultStatus,a=0===s?1:0;console.log("旧状态:",s),console.log("新状态:",a),this.$confirm("是否要修改该会员等级状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(m.f)(t.id,s).then(function(e){e&&200===e.code?(i.$message({type:"success",message:"修改成功!"}),i.getList()):(i.$message({type:"error",message:e&&e.message?e.message:"修改失败!"}),t.defaultStatus=s,i.$forceUpdate())}).catch(function(e){console.error("修改状态失败:",e),i.$message({type:"error",message:"修改失败!"}),t.defaultStatus=s,i.$forceUpdate()})}).catch(function(){i.$message({type:"info",message:"取消修改"}),t.defaultStatus=s,i.$forceUpdate()})},handleDialogConfirm:function(){var e=this;this.memberLevel.priviledgeFreeFreight=this.privilegeList.includes("priviledgeFreeFreight")?1:0,this.memberLevel.priviledgeSignIn=this.privilegeList.includes("priviledgeSignIn")?1:0,this.memberLevel.priviledgeComment=this.privilegeList.includes("priviledgeComment")?1:0,this.memberLevel.priviledgePromotion=this.privilegeList.includes("priviledgePromotion")?1:0,this.memberLevel.priviledgeMemberPrice=this.privilegeList.includes("priviledgeMemberPrice")?1:0,this.memberLevel.priviledgeBirthday=this.privilegeList.includes("priviledgeBirthday")?1:0,this.$refs.memberLevelForm.validate(function(t){if(!t)return e.$message({type:"warning",message:"表单验证失败，请检查输入!"}),!1;var i=u()({},e.memberLevel),s=void 0;if(e.isEdit)s=Object(m.e)(i);else{var a=o()({},i);delete a.id,s=Object(m.a)(a)}s.then(function(t){t&&200===t.code?(e.$message({type:"success",message:e.isEdit?"修改成功!":"添加成功!"}),e.dialogVisible=!1,e.getList()):e.$message({type:"error",message:t&&t.message?t.message:e.isEdit?"修改失败!":"添加失败!"})}).catch(function(t){console.error(e.isEdit?"修改会员等级失败:":"添加会员等级失败:",t),e.$message({type:"error",message:"网络错误，请稍后重试!"})})})},getList:function(){var e=this;this.listLoading=!0,this.list=[],Object(m.d)(this.listQuery).then(function(t){e.listLoading=!1;var i=t.data&&Array.isArray(t.data)?t.data:t.data&&Array.isArray(t.data.list)?t.data.list:[],s=[].concat(r()(new a.a(i.map(function(e){return e.name}).filter(Boolean))));e.levelNameOptions=s.map(function(e){return{label:e,value:e}});var l=[].concat(r()(i));e.listQuery.name&&(l=l.filter(function(t){return t.name&&t.name.toLowerCase().includes(e.listQuery.name.toLowerCase())})),null!==e.listQuery.status&&void 0!==e.listQuery.status&&(l=l.filter(function(t){return t.status===e.listQuery.status})),e.total=l.length;var n=e.listQuery,o=n.pageNum,c=n.pageSize,u=(o-1)*c,m=u+c;e.list=l.slice(u,m);var g=Math.ceil(e.total/c);e.$nextTick(function(){o>g&&g>0?(e.listQuery.pageNum=g,e.currentPage=g,e.getList()):g>1&&1===o&&e.$forceUpdate()})}).catch(function(t){e.listLoading=!1,e.list=[],e.total=0,console.error("获取会员等级列表失败:",t),e.$message.error("获取会员等级列表失败，请稍后重试")})}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container member-level-container"},[i("el-card",{staticClass:"filter-card",attrs:{shadow:"hover"}},[i("div",{staticClass:"filter-header"},[i("i",{staticClass:"el-icon-search filter-icon"}),e._v(" "),i("span",{staticClass:"filter-title"},[e._v("筛选搜索")]),e._v(" "),i("div",{staticClass:"filter-actions"},[i("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearchList()}}},[i("i",{staticClass:"el-icon-search"}),e._v("查询搜索\n        ")]),e._v(" "),i("el-button",{staticClass:"reset-btn",attrs:{size:"small"},on:{click:function(t){return e.handleResetSearch()}}},[i("i",{staticClass:"el-icon-refresh"}),e._v("重置\n        ")])],1)]),e._v(" "),i("div",{staticClass:"filter-content"},[i("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:e.listQuery,"label-width":"auto"}},[i("el-form-item",{staticClass:"filter-item",attrs:{label:"等级名称："}},[i("el-select",{staticClass:"filter-select",staticStyle:{width:"200px"},attrs:{placeholder:"请选择等级名称",clearable:""},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}},e._l(e.levelNameOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{staticClass:"filter-item",attrs:{label:"是否启用："}},[i("el-select",{staticClass:"filter-select",staticStyle:{width:"150px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.listQuery.defaultStatus,callback:function(t){e.$set(e.listQuery,"defaultStatus",t)},expression:"listQuery.defaultStatus"}},[i("el-option",{attrs:{label:"启用",value:1}}),e._v(" "),i("el-option",{attrs:{label:"禁用",value:0}})],1)],1)],1)],1)]),e._v(" "),i("el-card",{staticClass:"operate-card",attrs:{shadow:"hover"}},[i("div",{staticClass:"operate-header"},[i("i",{staticClass:"el-icon-tickets operate-icon"}),e._v(" "),i("span",{staticClass:"operate-title"},[e._v("会员等级列表")]),e._v(" "),i("el-button",{staticClass:"btn-add",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAdd()}}},[i("i",{staticClass:"el-icon-plus"}),e._v("添加会员等级\n      ")])],1)]),e._v(" "),i("div",{staticClass:"table-card-container"},[i("el-card",{staticClass:"table-card",attrs:{shadow:"hover"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"memberLevelTable",staticClass:"member-level-table",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"600"}}},[i("el-table-column",{attrs:{label:"等级编号",width:"100",align:"center",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"level-id"},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"等级名称",align:"center",prop:"name","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"level-name"},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"成长值下限",align:"center",prop:"growthPoint",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:"info",size:"small"}},[e._v(e._s(t.row.growthPoint))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"免运费标准",align:"center",prop:"freeFreightPoint",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"free-freight"},[e._v(e._s(t.row.freeFreightPoint)+" 元")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"折扣",align:"center",prop:"defaultDiscount",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:"success",size:"small"}},[e._v(e._s(t.row.defaultDiscount)+"%")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"评论成长值",align:"center",width:"120",prop:"commentGrowthPoint"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"comment-growth"},[e._v(e._s(t.row.commentGrowthPoint||0))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"特权",align:"center",width:"200",prop:"privileges"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"privilege-tags"},[t.row.priviledgeFreeFreight?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini",type:"success"}},[e._v("免邮")]):e._e(),e._v(" "),t.row.priviledgeSignIn?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini",type:"primary"}},[e._v("签到")]):e._e(),e._v(" "),t.row.priviledgeComment?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini",type:"warning"}},[e._v("评论奖励")]):e._e(),e._v(" "),t.row.priviledgePromotion?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini",type:"info"}},[e._v("专享活动")]):e._e(),e._v(" "),t.row.priviledgeMemberPrice?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini",type:"danger"}},[e._v("会员价")]):e._e(),e._v(" "),t.row.priviledgeBirthday?i("el-tag",{staticClass:"privilege-tag",attrs:{size:"mini"}},[e._v("生日特权")]):e._e(),e._v(" "),e.hasPrivileges(t.row)?e._e():i("span",{staticClass:"no-privilege"},[e._v("无特权")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"状态",width:"100",align:"center",prop:"defaultStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{staticClass:"status-switch",attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(i){return e.handleStatusChange(t.$index,t.row)}},model:{value:t.row.defaultStatus,callback:function(i){e.$set(t.row,"defaultStatus",i)},expression:"scope.row.defaultStatus"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticClass:"action-btn edit-btn",attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleUpdate(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-edit"}),e._v("编辑\n            ")]),e._v(" "),i("el-button",{staticClass:"action-btn delete-btn",attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-delete"}),e._v("删除\n            ")])]}}])})],1)],1)],1),e._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{staticClass:"custom-pagination",attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.listQuery.pageSize,"page-sizes":[10,15,20],"pager-count":7,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.handlePrevClick,"next-click":e.handleNextClick},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),e._v(" "),i("el-dialog",{staticClass:"member-level-dialog",attrs:{title:e.isEdit?"编辑会员等级":"添加会员等级",visible:e.dialogVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"dialog-content"},[i("el-form",{ref:"memberLevelForm",staticClass:"dialog-form",attrs:{model:e.memberLevel,"label-width":"120px",size:"small"}},[i("el-form-item",{staticClass:"form-item",attrs:{label:"等级名称：",prop:"name"}},[i("el-input",{staticClass:"form-input",attrs:{placeholder:"请输入等级名称"},model:{value:e.memberLevel.name,callback:function(t){e.$set(e.memberLevel,"name",t)},expression:"memberLevel.name"}})],1),e._v(" "),i("el-form-item",{staticClass:"form-item",attrs:{label:"成长值下限：",prop:"growthPoint"}},[i("el-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"请输入成长值下限"},model:{value:e.memberLevel.growthPoint,callback:function(t){e.$set(e.memberLevel,"growthPoint",t)},expression:"memberLevel.growthPoint"}})],1),e._v(" "),i("el-form-item",{staticClass:"form-item",attrs:{label:"免运费标准：",prop:"freeFreightPoint"}},[i("el-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"请输入免运费标准"},model:{value:e.memberLevel.freeFreightPoint,callback:function(t){e.$set(e.memberLevel,"freeFreightPoint",t)},expression:"memberLevel.freeFreightPoint"}},[i("template",{slot:"append"},[e._v("元")])],2)],1),e._v(" "),i("el-form-item",{staticClass:"form-item",attrs:{label:"默认折扣：",prop:"defaultDiscount"}},[i("el-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"请输入默认折扣"},model:{value:e.memberLevel.defaultDiscount,callback:function(t){e.$set(e.memberLevel,"defaultDiscount",t)},expression:"memberLevel.defaultDiscount"}},[i("template",{slot:"append"},[e._v("%")])],2)],1),e._v(" "),i("el-form-item",{staticClass:"form-item",attrs:{label:"评论赠送成长值：",prop:"commentGrowthPoint"}},[i("el-input",{staticClass:"form-input",attrs:{type:"number",placeholder:"请输入评论赠送成长值"},model:{value:e.memberLevel.commentGrowthPoint,callback:function(t){e.$set(e.memberLevel,"commentGrowthPoint",t)},expression:"memberLevel.commentGrowthPoint"}})],1),e._v(" "),i("el-form-item",{staticClass:"form-item privilege-item",attrs:{label:"特权设置：",prop:"privileges"}},[i("el-checkbox-group",{staticClass:"privilege-checkbox-group",model:{value:e.privilegeList,callback:function(t){e.privilegeList=t},expression:"privilegeList"}},[i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgeFreeFreight"}},[e._v("免邮特权")]),e._v(" "),i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgeSignIn"}},[e._v("签到特权")]),e._v(" "),i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgeComment"}},[e._v("评论获奖励特权")]),e._v(" "),i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgePromotion"}},[e._v("专享活动特权")]),e._v(" "),i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgeMemberPrice"}},[e._v("会员价格特权")]),e._v(" "),i("el-checkbox",{staticClass:"privilege-checkbox",attrs:{label:"priviledgeBirthday"}},[e._v("生日特权")])],1)],1),e._v(" "),i("el-form-item",{staticClass:"form-item",attrs:{label:"是否启用：",prop:"defaultStatus"}},[i("el-radio-group",{staticClass:"status-radio-group",model:{value:e.memberLevel.defaultStatus,callback:function(t){e.$set(e.memberLevel,"defaultStatus",t)},expression:"memberLevel.defaultStatus"}},[i("el-radio",{staticClass:"status-radio",attrs:{label:1}},[e._v("启用")]),e._v(" "),i("el-radio",{staticClass:"status-radio",attrs:{label:0}},[e._v("禁用")])],1)],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"cancel-btn",attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n        取消\n      ")]),e._v(" "),i("el-button",{staticClass:"confirm-btn",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleDialogConfirm()}}},[e._v("\n        确定\n      ")])],1)])],1)},staticRenderFns:[]};var b=i("VU/8")(h,f,!1,function(e){i("pf28")},"data-v-33556bd6",null);t.default=b.exports},pf28:function(e,t){}});
//# sourceMappingURL=22.a8d688eef5b223e388b5.js.map